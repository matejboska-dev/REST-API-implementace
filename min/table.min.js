function closeIFrame2(){$(".myframe2").hide(),location.reload()}$(document).ready((function(){var cookies=document.cookie.split(";"),cookie="";for(const c of cookies)if(c.includes("search=")){cookie=c.split("=")[1];break}$("#basic").DataTable({stateSave:!0,dom:"lBftrip",buttons:["colvis","excel","print"],scrollX:"auto",lengthMenu:[[-1,10,20,30,40,50],["All",10,20,30,40,50]],scrollY:"700px",scrollCollapse:!0,search:{search:cookie},columnDefs:[{targets:0,orderable:!1}],language:{search:"",searchPlaceholder:"Vyhledávání"},initComplete:function(settings,json){$(".dataTables_scrollBody").height($(window).innerHeight()-180)}}),$(".dataTables_length").append($('<div id ="hamburger"><div class="table-filter"><label>Aktivní:<input type="checkbox" id="check-active" checked></label><button class="bn49" id="delete-btn">Vymazat vybrané</button><button class="bn49" id="export-btn">Exportovat vybrané</button><a class="bn49" hre id="link">Přidání Firmy</a><a class="bn49 " href="/columns/columnForm.php">Úpravy sloupců</a><a class="bn49 " href="/events/tableEvents.php">Události</a><button class="bn49" id="edit-rows">Upravit vybrany slupec</button><input id="email-btn" class="bn49" type="submit" value="Poslat email vybranym"></div></div>')),$(".myframe").hide(),document.getElementById("frame").src="firms/insertFirmForm.php",$("#link").click((function(){var iframe;$(".myframe").show(),document.getElementById("frame").onload=function(){$(".myframe").hide(),location.reload()}})),$("#closeIframe").click((function(){$(".myframe").hide()})),$(".myframe2").hide(),document.getElementById("frame2").src="editFirm/editFirmForm.php",$("#closeIframe2").click((function(){$(".myframe2").hide()})),$("#basic").DataTable().on("search.dt",(function(){var serachInput,value=$("#basic_filter label input").val();""==value?Setcookie(""):(Setcookie(value),window.history.replaceState&&window.history.replaceState("","CRM",window.location.origin+"?search="+value))}));var checkActive=$("#check-active");function Setcookie(value){const d=new Date;d.setTime(d.getTime()+432e5);let expires="expires="+d.toUTCString();document.cookie="search="+value+";"+expires}$("#basic").DataTable().column(4).search("1",!0,!1,!0).draw(),checkActive.on("change",(function(){1==checkActive.prop("checked")?$("#basic").DataTable().column(4).search("1",!0,!1,!0).draw():$("#basic").DataTable().column(4).search("0",!0,!1,!0).draw()})),$("#delete-btn").click((function(){var selected=$(".check:checked");selected.length>0&&$.confirm({title:"Opravdu chcete smazat tyto firmy ?",content:"Smazat "+selected.length+" firem?",buttons:{yes:{text:"Ano",btnClass:"btn-blue",keys:["enter","shift"],action:function(){var array=[];for(const tr of selected)array.push($(tr).attr("id"));console.log(array),$.ajax({url:"/firms/deleteFirms.php",method:"POST",data:{ids:array},success:function(response){console.log(response),location.reload()},error:function(){alert("error")}})}},no:{text:"Ne",btnClass:"btn-gray",keys:["enter","shift"],action:function(){}}}})})),$("#export-btn").click((function(){var selected=$(".selected");if(selected.length>0){var array=[];for(const tr of selected)array.push($(tr).attr("id"));console.log(array);var form=document.createElement("form");form.method="POST",form.action="/firms/exportFirms.php";var data=document.createElement("input"),json={ids:array};data.value=JSON.stringify(json),data.name="ids",data.type="hidden",form.appendChild(data),document.body.appendChild(form),form.submit()}})),$("#email-btn").click((function(event){var selected=$(".selected");if(selected.length>0){for(var mailtoStr="mailto:?bcc=",x=0;x<selected.length;x++){var item=selected[x],email=$(item).find(".email").attr("title");""!=email&&(mailtoStr+=email,x!=selected.length-1&&(mailtoStr+=","))}window.location=mailtoStr}})),$("#edit-rows").click((function(){var selected=$(".selected");if(selected.length>0){ids_str="";for(var x=0;x<selected.length;x++)ids_str+=$(selected[x]).attr("id")+";";sessionStorage.setItem("ids",ids_str),window.location="./firms/editRowsForm.php"}}))})),$(window).resize((function(){$(".dataTables_scrollBody").height($(window).innerHeight()-180)}));